# Performance Test Debug Cases
# 
# æ ¼å¼è¯´æ˜:
#   test_perf_sanity.py::test_e2e[test_case_id]
# 
# test_case_id æ ¼å¼:
#   - Agg æ¨¡å¼: {test_type}-{config_yml}[-{server_config_name}]
#   - Disagg æ¨¡å¼: {test_type}-{config_yml}
# 
# test_type:
#   - aggr / aggr_upload: èšåˆæ¨¡å¼ï¼ˆå•èŠ‚ç‚¹æˆ–å¤šèŠ‚ç‚¹ï¼‰
#   - disagg / disagg_upload: åˆ†ç¦»å¼æ¨¡å¼
# 
# ğŸ¯ è‡ªåŠ¨è¯†åˆ«æµ‹è¯•ç±»å‹ (æ— éœ€æ‰‹åŠ¨æ ‡è®°ï¼)
#   - Single-Agg: è‡ªåŠ¨è¯†åˆ«å•èŠ‚ç‚¹æµ‹è¯•
#   - Multi-Agg: è‡ªåŠ¨è¯†åˆ«å¤šèŠ‚ç‚¹èšåˆæµ‹è¯•ï¼ˆé€šè¿‡è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„ gpus/gpus_per_nodeï¼‰
#   - Disagg: è‡ªåŠ¨è¯†åˆ«åˆ†ç¦»å¼æµ‹è¯•ï¼ˆé€šè¿‡é…ç½®æ–‡ä»¶æˆ–å‘½åè§„åˆ™ï¼‰
# 
# âš™ï¸ æ‰‹åŠ¨æ ‡è®° (å¯é€‰ï¼Œç”¨äºè¦†ç›–è‡ªåŠ¨è¯†åˆ«):
#   åœ¨è¡Œå°¾æ·»åŠ  # mode:multi-agg æˆ– # mode:disagg
#   ç¤ºä¾‹: test_perf_sanity.py::test_e2e[aggr-config_name]  # mode:multi-agg
# 
# ä½¿ç”¨æ–¹æ³•:
#   1. ä» pytest è¾“å‡ºæˆ– CI æ—¥å¿—å¤åˆ¶å¤±è´¥çš„æµ‹è¯•
#   2. ç²˜è´´åˆ°æ­¤æ–‡ä»¶ï¼ˆä¿æŒ test_perf_sanity.py::test_e2e[...] æ ¼å¼ï¼‰
#   3. åœ¨ Jenkins ä¸­é€‰æ‹© TESTLIST = "debug_cases"
#   4. è‡ªåŠ¨è¯†åˆ«æµ‹è¯•ç±»å‹å¹¶è·¯ç”±åˆ°å¯¹åº”çš„æ‰§è¡Œè„šæœ¬
# 
# ç¤ºä¾‹ï¼ˆæ¥è‡ªå®é™…é…ç½®æ–‡ä»¶ï¼‰:
#   test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_grace_blackwell-r1_fp4_v2_tp4_mtp3_1k1k]
#   test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_2_nodes_grace_blackwell-r1_fp4_v2_dep8_mtp1_1k1k]
#   test_perf_sanity.py::test_e2e[disagg_upload-deepseek-r1-fp4_1k1k_ctx1_gen1_dep8_bs768_eplb0_mtp0_ccb-UCX]

# ============================================
# Single-Agg æµ‹è¯•ï¼ˆå•èŠ‚ç‚¹èšåˆï¼‰
# ============================================

# DeepSeek R1 FP4 V2 - Grace Blackwell (4 GPUs)
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_grace_blackwell-r1_fp4_v2_tp4_mtp3_1k1k]
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_grace_blackwell-r1_fp4_v2_tep4_mtp3_1k1k]
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_grace_blackwell-r1_fp4_v2_dep4_mtp1_1k1k]

# DeepSeek V3.2 FP4 - Grace Blackwell
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_v32_fp4_grace_blackwell-v32_fp4_tep4_mtp3_1k1k]
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_v32_fp4_grace_blackwell-v32_fp4_dep4_mtp1_1k1k]

# K2 Thinking FP4 - Grace Blackwell
test_perf_sanity.py::test_e2e[aggr_upload-k2_thinking_fp4_grace_blackwell-k2_thinking_fp4_tep4_8k1k]

# GPT-OSS 120B FP4 - Grace Blackwell
test_perf_sanity.py::test_e2e[aggr_upload-gpt_oss_120b_fp4_grace_blackwell-gpt_oss_fp4_tp2_1k8k]
test_perf_sanity.py::test_e2e[aggr_upload-gpt_oss_120b_fp4_grace_blackwell-gpt_oss_fp4_dep2_1k1k]

# ============================================
# Multi-Agg æµ‹è¯•ï¼ˆå¤šèŠ‚ç‚¹èšåˆ - 2 Nodesï¼‰
# ============================================

# DeepSeek R1 FP4 V2 - 2 Nodes (8 GPUs total)
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_2_nodes_grace_blackwell-r1_fp4_v2_dep8_mtp1_1k1k]
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_2_nodes_grace_blackwell-r1_fp4_v2_dep8_mtp1_8k1k]
test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_2_nodes_grace_blackwell-r1_fp4_v2_tep8_mtp3]

# K2 Thinking FP4 - 2 Nodes (8 GPUs total)
test_perf_sanity.py::test_e2e[aggr_upload-k2_thinking_fp4_2_nodes_grace_blackwell-k2_thinking_fp4_tep8_32k8k]
test_perf_sanity.py::test_e2e[aggr_upload-k2_thinking_fp4_2_nodes_grace_blackwell-k2_thinking_fp4_dep8_32k8k]

# ============================================
# Disagg æµ‹è¯•ï¼ˆåˆ†ç¦»å¼ - 3 Nodesï¼‰
# ============================================

# DeepSeek R1 FP4 - Disaggregated (12 GPUs total, 3 nodes)
test_perf_sanity.py::test_e2e[disagg_upload-deepseek-r1-fp4_1k1k_ctx1_gen1_dep8_bs768_eplb0_mtp0_ccb-UCX]

# ============================================
# å¿«é€Ÿå‚è€ƒ
# ============================================
#
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æµ‹è¯•:
#   cd tests/integration/defs/perf
#   pytest test_perf_sanity.py --collect-only -q
#
# ä½¿ç”¨ pytest -k è¿‡æ»¤:
#   pytest test_perf_sanity.py -k "deepseek and grace"
#   pytest test_perf_sanity.py -k "aggr_upload and not disagg"
#
# è¿è¡Œå•ä¸ªæµ‹è¯•:
#   pytest test_perf_sanity.py::test_e2e[aggr_upload-deepseek_r1_fp4_v2_grace_blackwell-r1_fp4_v2_tp4_mtp3_1k1k]
#
# é…ç½®æ–‡ä»¶ä½ç½®:
#   Single-Agg / Multi-Agg: tests/scripts/perf-sanity/*.yaml
#   Disagg: tests/integration/defs/perf/disagg/test_configs/disagg/perf/*.yaml

